/**
 * simple-deploy.js v0.1.0
 * (c) 2019 iboying(weboying@gmail.com)
 * @license MIT
 */
"use strict";var ref=require("child_process"),spawn=ref.spawn,SimpleDeploy=function(e){var t=e.username,o=e.host,r=e.localPath,s=e.remotePath,l=e.port;if(!(t&&o&&r&&s))throw new Error("The params must has 'host、username、remotePath、localPath' variables and optional variable 'port'.");this.username=t,this.host=o,this.localPath=r,this.remotePath=s,this.port=l||22};SimpleDeploy.shell=function(e){var t=e.trim().replace(/\s{2,}/g," ").split(" "),s=spawn(t[0],t.splice(1));return new Promise(function(o,r){s.stdout.on("data",function(e){console.log(e.toString())}),s.stderr.on("data",function(e){console.log(e.toString())}),s.on("close",function(e){if(0!==e){var t=new Error("Process exited with code "+e);r(t)}else o()})})},SimpleDeploy.prototype.remote=function(e){var t=this,o=t.username,r=t.host,s="ssh -p "+t.port+" "+o+"@"+r+" "+e;return SimpleDeploy.shell(s)},SimpleDeploy.prototype.sync=function(e){void 0===e&&(e="-avI");var t=this,o=t.username,r=t.host,s="rsync "+e+" -r --delete --port="+t.port+" "+t.localPath+" "+o+"@"+r+":"+t.remotePath;return SimpleDeploy.shell(s)},module.exports=SimpleDeploy;