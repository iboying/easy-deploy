/**
 * easy-deploy.js v0.1.0
 * (c) 2019 iboying(weboying@gmail.com)
 * @license MIT
 */
"use strict";var ref=require("child_process"),exec=ref.exec,chalk=require("chalk"),EasyDeploy=function(e){var o=e.username,t=e.host,r=e.localPath,s=e.remotePath,a=e.port;if(!(o&&t&&r&&s))throw new Error("The params must has 'host、username、remotePath、localPath' variables and optional variable 'port'.");this.username=o,this.host=t,this.localPath=r,this.remotePath=s,this.port=a||22};EasyDeploy.shell=function(e){return console.log(chalk.cyan("RUN "+e)),new Promise(function(o,t){var r=exec(e);r.stdout.on("data",function(e){console.log(chalk.blue(e.toString()))}),r.stderr.on("data",function(e){console.log(chalk.red(e.toString()))}),r.on("exit",function(e){r=null,0===e?o():t(new Error("Process exited with code "+e))})})},EasyDeploy.prototype.remote=function(e){var o=this,t=o.username,r=o.host,s="ssh -p "+o.port+" "+t+"@"+r+" "+e;return EasyDeploy.shell(s)},EasyDeploy.prototype.sync=function(e){void 0===e&&(e="-avI");var o=this,t=o.username,r=o.host,s="rsync "+e+" -r --delete -e 'ssh -p "+o.port+"' "+o.localPath+" "+t+"@"+r+":"+o.remotePath;return EasyDeploy.shell(s)},module.exports=EasyDeploy;