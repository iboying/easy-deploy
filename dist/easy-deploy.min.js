/**
 * easy-deploy.js v0.3.1
 * (c) 2020 iboying(weboying@gmail.com)
 * @license MIT
 */
"use strict";var ref=require("child_process"),exec=ref.exec,chalk=require("chalk"),EasyDeploy=function(e){var t=e.username,o=e.host,r=e.localPath,s=e.remotePath,a=e.port;if(!(t&&o&&r&&s))throw new Error("The params must has 'host、username、remotePath、localPath' variables and optional variable 'port'.");this.username=t,this.host=o,this.localPath=r,this.remotePath=s,this.port=a||22};EasyDeploy.shell=function(e){return new Promise(function(t,o){var r=exec(e),s="";r.stdout.on("data",function(e){var t=e.toString();console.log(chalk.blue(t)),s+=t}),r.stderr.on("data",function(e){console.log(chalk.red(e.toString()))}),r.on("exit",function(e){r=null,0===e?t(s):o(new Error("Process exited with code "+e)),s=null})})},EasyDeploy.prototype.remote=function(e){var t=this,o=t.username,r=t.host,s="ssh -p "+t.port+" "+o+"@"+r+" "+e;return EasyDeploy.shell(s)},EasyDeploy.prototype.sync=function(e){void 0===e&&(e="-avI");var t=this,o=t.username,r=t.host,s="rsync "+e+" -r -e 'ssh -p "+t.port+"' "+t.localPath+" "+o+"@"+r+":"+t.remotePath;return EasyDeploy.shell(s)},module.exports=EasyDeploy;